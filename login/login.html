<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="./login.css" />
    <title>Chat App - Login</title>
  </head>
  <body>
    <header>
      <div class="logo"><a href="../index.html">Chat app</a></div>
      <div class="nav-links">
        <a href="../login/login.html">Login</a>
        <a href="../register/register.html">Register</a>
        <a href="../chat/chat.html">Chat</a>
      </div>
      <div class="user-info">
        <span class="username"><a href="../userPage/userPage.html" class="username-text">Username</a></span
            ></span>
        <div class="image-container"></div>
      </div>
    </header>

    <main class="wrapper">
      <div class="login-container">
        <h1>Login</h1>
        <form id="login-form">
          <div class="form-group">
            <label for="login">Login:</label>
            <input type="text" id="login" name="login" required />
          </div>
          <div class="form-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required />
          </div>
          <div class="form-group">
            <button type="submit" class="button" id="login-button">Login</button>
          </div>
        </form>
        <p>
          Don't have an account?
          <a href="../register/register.html">Sign up</a>
        </p>
      </div>
    </main>

    <footer>
      <p>&copy; 2023 Chat App. All rights reserved.</p>
    </footer>

    <script src="../app.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var loginForm = document.getElementById("login-form");
        var loginButton = document.getElementById("login-button");

        loginForm.addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent form submission

          var loginInput = document.getElementById("login");
          var passwordInput = document.getElementById("password");

          var inputData = {
            login: loginInput.value,
            pass: passwordInput.value,
          };

          // Call the Login function from app.js
          Login(inputData)
            .then(function (response) {
              console.log(response);
              const resp = JSON.parse(response);
              setLocalUserInfo(resp.token, resp.userId, resp.login);
              alert("Login successful!");
              // Handle successful login
            })
            .catch(function (error) {
              console.error(error);
              alert("Login failed!");
              // Handle login error
            });
        });
      });
    </script>




  </body>
</html>
